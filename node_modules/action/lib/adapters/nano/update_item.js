var update_item = function(conString,table,params,callback){
	var nano = require('nano')(conString);
	var db = nano.use(config.db.database_name);
	
	//This is a shim provided from 
	//http://writings.nunojob.com/2012/07/How-To-Update-A-Document-With-Nano-The-CouchDB-Client-for-Node.js.html
	db.update = function(obj, key, callback) {
 		var db = this;
 		db.get(key, function (error, existing) { 
 	 		if(!error) obj._rev = existing._rev;
  			db.insert(obj, key, callback);
 		});
	}
	var params = JSON.parse(params.bodyParams);
	if(typeof params != 'object'){
		var params = JSON.parse(params);
	}
	
	db.update(params, params.id, function(err, body){
		if (!err) {
			callback(null, body);
		} else {
			callback(err,null);
		}
	});	
};

module.exports = update_item;